<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="shortcut icon" href="cloud.png" type="image/png">
  <!--Import Google Icon Font-->
       <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
       <link type="text/css" rel="stylesheet" href="../fluid-beta.css"  media="screen,projection"/>
       <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!--OpenGraph -->
  <meta property="og:url" content="https://fluid.js.org" />
  <meta property="og:title" content="Fluid UI" />
  <meta property="og:description" content="Easy to use and modern CSS with a dark mode" />
  <meta property="og:image" content="https://fluid.js.org/icon.png" />

  <meta charset="utf-8">
  <title>Fluid Cloud Console</title>
<meta name="description" content="">
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
</head>


<body class="auto">
  <script src="https://cdn.rawgit.com/showdownjs/showdown/1.8.6/dist/showdown.min.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="../fluid-beta.js"></script>

<script src="https://www.gstatic.com/firebasejs/5.1.0/firebase.js"></script>
<script>
var config = {
  apiKey: "AIzaSyAzvQw_Pzt2WD9xge88VueFsqxfN-pLYkw",
  authDomain: "fluid-ui.firebaseapp.com",
  databaseURL: "https://fluid-ui.firebaseio.com",
  projectId: "fluid-ui",
  storageBucket: "fluid-ui.appspot.com",
  messagingSenderId: "444063761692"
};
firebase.initializeApp(config);
var firestore = firebase.firestore();
var database = firestore.collection("Sites");

googleAuth = new firebase.auth.GoogleAuthProvider();
githubAuth = new firebase.auth.GithubAuthProvider();

function githubLogin() {
  firebase.auth().signInWithRedirect(githubAuth);
}
function googleLogin() {
  firebase.auth().signInWithRedirect(googleAuth);
}

firebase.auth().onAuthStateChanged(function(userr) {
  if (userr) {
    user = userr;
    $("#useriddisp").html(user.uid);
    $("#authscreen").hide();
    $("#addscreen").show();
    $("#signout").show();
    database.doc(user.uid).get().then(function(doc) {
        if (doc.exists) {
          sitedata = doc.data();
          for (var i = 0; i < sitedata.siteList.length; i++) {
            if (sitedata.siteList[i] !== "deleted") renderSite(sitedata.siteList[i]);
          }
        } else {
          sitedata = {
            siteList: []
          }
          database.doc(user.uid).set(sitedata);
        }
      });

  }
});

function addSite() {
  newid = $("#newsiteid").val();
  sitedata.siteList.push(newid);
  sitedata[newid] = {
    alert: {
      title: "",
      content: ""
    },
    splash: {
      title: "",
      content: ""
    },
    toast: {
      title: "",
      content: ""
    }
  }
  database.doc(user.uid).set(sitedata);
  renderSite(newid);
  fluid.unsplash();
}
function renderSite(siteid) {
var splashstatus = "disabled"
if (sitedata[siteid].splash.title !== "") splashstatus = "enabled"
$("#sitelist").html(`
  <div class="section">
    <div class="header">
  <i class="material-icons">public</i>
  <h5>` + siteid + `</h5>
</div>
<div class="body" style="padding-top: 0px;">
  <h5>Splash screen</h5>
  <p>Splash screen is currently <b>` + splashstatus + `</b>.</p>
  <br />
  <input class="title" value="` + sitedata[siteid].splash.title + `" placeholder="Splash screen title" />
  <input class="splashcontent" value="` + sitedata[siteid].splash.content + `" placeholder="Splash screen content" />
  <br />
  <div class="row"><button onclick="splash(true, '` + siteid + `', this)" class="btn">Enable</button><button onclick="splash(false, '` + siteid + `', this)" class="btn">Disable</button></div>
</div>
</div>
  ` + $("#sitelist").html());
}
function splash(enable, siteid, element) {
if (enable) {
  $(element).parent().siblings("p").children("b").html("enabled")
  sitedata[siteid].splash.title = $(element).parent().siblings("input.title").val()
  sitedata[siteid].splash.content = $(element).parent().siblings("input.splashcontent").val()
  database.doc(user.uid).set(sitedata);
} else {
  $(element).parent().siblings("p").children("b").html("disabled")
  $(element).parent().siblings("input.title").val("")
  $(element).parent().siblings("input.splashcontent").val("")
  sitedata[siteid].splash.title = $(element).parent().siblings("input.title").val()
  sitedata[siteid].splash.content = $(element).parent().siblings("input.splashcontent").val()
  database.doc(user.uid).set(sitedata);
}
}
</script>
  <div style="margin-top: 100px;margin-top: 150px;" class="container center">
      <img style="width:250px;height:250px;margin-right: 50px;vertical-align:middle;" alt="" class="center" src="cloud.png"></img>
      <div style="display:inline-block;vertical-align:middle;">
      <h1>Fluid Cloud</h1>
      <h4 style="color: orange">beta</h4>
      <h5 style="display:none;" id="signout"><a href="#" onclick="firebase.auth().signOut();window.location.reload();">Sign out</a></h5>
    </div>

      </div>
      <br /><br />
      <br /><br />
      <div class="container">
        <br /><br />
        <div id="authscreen" class="section">
          <div class="header">
        <i class="material-icons">lock</i>
        <h5>Sign In</h5>
      </div>
      <div class="body" style="padding-top: 0px;">
        <div style="display:none">
        <input placeholder="Email" />
        <br />
        <input type="password" placeholder="Password" />
        <br />
        <button onclick="$(this).parent().hide();$(this).parent().siblings('div').show();" class="btn">Back</button>
        <button class="btn">Sign In</button>
      </div>
      <div>
        <p>If you do not have an account, it will be created for you</p>
        <!-- <button onclick="$(this).parent().hide();$(this).parent().siblings('div').show();" class="btn">Sign In with Email</button> -->
        <button onclick="googleLogin()" class="btn">Sign In with google_logo</button>
        <button onclick="githubLogin()" class="btn">Sign In with GitHub</button>
      </div>
      </div>
</div>
        <div style="display:none;" id="addscreen" class="section">
          <div class="header">
        <i class="material-icons">add</i>
        <h5>Add Site</h5>
      </div>
      <div class="body" style="padding-top: 0px;">
        <p>Your Fluid Cloud user ID is <b id="useriddisp">dsafdsajfdsafjd</b></p>
        <br />
        <button onclick="fluid.splash('.splash.addsite')" class="btn">Add Site</button>
      </div>
</div>
      <br />
      <div id="sitelist">
      </div>
      <div class="splash addsite" title="Add site">
        <p>Enter the same ID that you defined (or plan to define) for the cloudProject key on your site. <a href="../beta.html#cloud">Learn more</a></p>
        <input id="newsiteid" placeholder="Site ID" />
        <br />
        <button onclick="addSite();" class="btn">Add site</button>
      </div>
      </div>
           <br /><br /><br /><br />

<p style="text-align:center">(c) 2018 jottocraft&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://github.com/jottocraft/fluid/blob/master/LICENSE">license</a></p>
  <br /><br />
  </div>

</body>
</html>
